/*! GalleriomJS (1.02) (C) Denis Mušić. GPL2 @license: http://www.gnu.org/licenses/ */
/**
 * Copyright (C) 2018  Denis Mušić
 * This program is free software; you can redistribute it and/or
 * modify it under the terms of the GNU General Public License
 * as published by the Free Software Foundation; either version 2
 * of the License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 */
!function(t,e){function i(t){this.appbox=t||0,this.appView=0,this.galleryHolder=0,this.galleryCollection=[],this.gadget={thumbsView:!0,imageFit:"contain",caption:!1,preview:!1},this.leftNav=0,this.rightNav=0,this.dimensions={w:0,h:0,quantity:-1},this.tools={iClick:0,IE:!1,metrics:{w:"px",h:"px"}},this.swipe={startX:0,treshold:0,left:0,divider:0,lmb:!1}}var s;i.prototype.startApp=function(t){var e=this;e.addListeners("load",t,function(){e.initialize(e),e.addListeners("resize",t,function(){var t,i=0;for(t=e.dimensions.quantity+1,e.setAppFrame(),e.elAdjuster(e.appView,e.dimensions),e.elAdjuster(e.galleryHolder,{w:e.dimensions.w*t,h:e.dimensions.h});i<t;++i)e.elAdjuster(e.galleryCollection[i],e.dimensions)})})},i.prototype.initialize=function(t){try{t.detectImages(t.appbox.getElementsByTagName("img")),t.detectIEBrowser(),t.setAppFrame(),t.createView(),t.createNavigation(),t.createThumbsView(),t.setTreshold(t.dimensions.w),t.setLeftRect(document.getElementById("galleriom-viewbox")),t.setScreenDivider(t.dimensions.w),t.addListeners("click",t.leftNav,function(e){t.moveLeft(e)}),t.addListeners("click",t.rightNav,function(e){t.moveRight(e)}),t.addListeners("touchstart",t.galleryHolder,function(e){t.swipeTouchStart(e)}),t.addListeners("touchmove",t.galleryHolder,function(e){t.swipeTouchMove(e)}),t.addListeners("touchend",t.galleryHolder,function(e){t.swipeTouchEnd(e)}),t.addListeners("mousedown",t.galleryHolder,function(e){t.swipeMouseStart(e)}),t.addListeners("mousemove",t.galleryHolder,function(e){t.swipeMouseMove(e)}),t.addListeners("mouseup",t.galleryHolder,function(e){t.swipeMouseEnd(e)})}catch(e){}},i.prototype.getWidth=function(t){var e=t.offsetWidth;return e>0?parseInt(e):0},i.prototype.getHeight=function(t){var e=t.offsetHeight;return e>0?parseInt(e):0},i.prototype.getSizeNavBar=function(t){return document.getElementById(t).offsetWidth},i.prototype.getDeltaX=function(t,e,i,s){return i&&s?t-e+i*s:(i=0,s=0,t-e)},i.prototype.getMaxMove=function(t,e,i,s){return t*e+i*s},i.prototype.getMinMove=function(t,e){return t*e*-1},i.prototype.getNavArea=function(t,e){return t-e},i.prototype.getPointerDistance=function(t,e){return t/e},i.prototype.setAppFrame=function(){this.appbox.hasAttribute("data-width")&&this.appbox.getAttribute("data-width"),this.appbox.hasAttribute("data-height")&&this.appbox.getAttribute("data-height"),this.grabber(this.appbox),this.dimensions.w=this.getWidth(this.appbox),this.dimensions.h=this.getHeight(this.appbox)},i.prototype.setWidth=function(t,e){"undefined"==typeof e&&(e=0),0===e?t.style.width="auto":t.style.width=e+this.tools.metrics.w},i.prototype.setHeight=function(t,e){"undefined"==typeof e&&(e=0),0===e?t.style.height="auto":t.style.height=e+this.tools.metrics.h},i.prototype.setClassAttr=function(t,e){t.className=e},i.prototype.setTreshold=function(t){this.swipe.treshold=(t-this.getSizeNavBar("galleriom-left-nav")+this.getSizeNavBar("galleriom-right-nav"))/2},i.prototype.setLeftRect=function(t){this.swipe.left=t.getBoundingClientRect().left},i.prototype.setScreenDivider=function(t){this.swipe.divider=this.swipe.left+t/2},i.prototype.createImages=function(t){"undefined"==typeof t&&(t=0);var e,i,s=0;for(this.galleryCollection=document.querySelectorAll("#galleriom-jsgallery-app img"),e=this.galleryCollection.length;s<e;++s)i=this.galleryCollection[s],this.elAdjuster(i,t),this.setClassAttr(i,"galleriom-img "+this.gadget.imageFit),this.gadget.preview||this.addListeners("click",i,function(t){t.preventDefault()}),this.dimensions.quantity++},i.prototype.createView=function(){var t=this.appbox.children;this.appView=document.createElement("div"),this.galleryHolder=document.createElement("div"),this.setAttributes(this.appView,{id:"galleriom-viewbox","class":"galleriom-viewbox",style:"width: "+this.dimensions.w+this.tools.metrics.w+";"}),this.setAttributes(this.galleryHolder,{id:"galleriom-holder",style:"width: "+this.dimensions.w*t.length+this.tools.metrics.w+";"}),this.createImages(this.dimensions),this.multipleAppend(this.galleryHolder,t),this.appView.appendChild(this.galleryHolder),this.appbox.appendChild(this.appView)},i.prototype.createNavigation=function(){var t={};t.left=document.createElement("div"),t.right=document.createElement("div"),t.left.appendChild(document.createElement("i")),t.right.appendChild(document.createElement("i")),this.tools.IE?(this.setAttributes(t.left,{id:"galleriom-left-nav","class":"galleriom-gallery-nav-ie left-nav-ie disabled"}),this.setAttributes(t.right,{id:"galleriom-right-nav","class":"galleriom-gallery-nav-ie right-nav-ie"})):(this.setAttributes(t.left,{id:"galleriom-left-nav","class":"galleriom-gallery-nav left-nav disabled"}),this.setAttributes(t.right,{id:"galleriom-right-nav","class":"galleriom-gallery-nav right-nav"})),this.leftNav=t.left,this.rightNav=t.right,this.appbox.children[0].appendChild(this.leftNav),this.appbox.children[0].appendChild(this.rightNav),this.recalcPosition(this.tools.iClick)},i.prototype.createThumbsView=function(){var t,e,i;if(t=this,e=document.createElement("div"),this.tools.IE?e.className="galleriom-thumbs-view-ie":e.className="galleriom-thumbs-view",this.gadget.thumbsView){var s=this.galleryHolder.children;for(var a in s){if(s.hasOwnProperty(a)&&!isNaN(parseInt(a))){var o,l;l=document.createElement("img"),i=document.createElement("div"),o="A"===s[a].nodeName?s[a].getAttribute("href"):this.galleryCollection[parseInt(a)].getAttribute("src"),this.setAttributes(l,{src:o,alt:"Thumb-no."+a,"data-no":a}),s[a]===s[0]&&(l.className="selected-thumb")}this.addListeners("click",i,function(e){t.thumbsToView(e)}),i.className="galleriom-thumbs",i.appendChild(l),e.appendChild(i)}}else for(var r=0,n=this.dimensions.quantity+1;r<n;++r)i=document.createElement("div"),0===r?this.setAttributes(i,{"class":"galleriom-thumbs-dotts selected-thumb","data-no":r}):this.setAttributes(i,{"class":"galleriom-thumbs-dotts","data-no":r}),this.addListeners("click",i,function(e){t.thumbsToView(e)}),e.appendChild(i);this.appbox.appendChild(e),this.appbox.style.height="auto"},i.prototype.moveLeft=function(){this.tools.iClick--,this.recalcPosition(this.tools.iClick)},i.prototype.moveRight=function(){this.tools.iClick++,this.recalcPosition(this.tools.iClick)},i.prototype.thumbsToView=function(t){var e;e=+t.target.dataset.no,this.recalcPosition(e)},i.prototype.swipeTouchStart=function(t){t.preventDefault(),this.swipe.startX=t.changedTouches[0].pageX},i.prototype.swipeTouchMove=function(t){t.preventDefault();var e,i,s,a,o;e=this.galleryHolder,i=t.changedTouches[0],s=this.getDeltaX(this.swipe.startX,i.pageX,this.tools.iClick,this.dimensions.w),a=this.getMaxMove(this.dimensions.w,this.dimensions.quantity,this.swipe.treshold,.5),o=this.getMinMove(this.swipe.treshold,.5),s>o&&s<a&&(e.style.transition="none",e.style.marginLeft=s*-1+"px")},i.prototype.swipeTouchEnd=function(t){t.preventDefault();var e,i,s,a;return e=t.changedTouches[0],i=this.getDeltaX(this.swipe.startX,e.pageX),s=this.getNavArea(this.swipe.divider,this.swipe.treshold),a=this.getPointerDistance(this.swipe.treshold,2),!!i&&(this.recalcPosition(this.tools.iClick),void this.positionControl(i,a,e.pageX,s))},i.prototype.swipeMouseStart=function(t){t.preventDefault(),this.swipe.startX=t.pageX,1===t.which&&(this.swipe.lmb=!0)},i.prototype.swipeMouseMove=function(t){t.preventDefault();var e,i,s,a;e=this.galleryHolder,i=this.getDeltaX(this.swipe.startX,t.pageX,this.tools.iClick,this.dimensions.w),s=this.getMaxMove(this.dimensions.w,this.dimensions.quantity,this.swipe.treshold,.5),a=this.getMinMove(this.swipe.treshold,.5),1===t.which&&this.swipe.lmb&&(e.style.transition="none",i>a&&i<s&&(e.style.marginLeft=i*-1+"px"))},i.prototype.swipeMouseEnd=function(t){t.preventDefault();var e,i,s;return e=this.getDeltaX(this.swipe.startX,t.pageX),i=this.getNavArea(this.swipe.divider,this.swipe.treshold),s=this.getPointerDistance(this.swipe.treshold,2),this.swipe.lmb=!1,!!e&&(this.recalcPosition(this.tools.iClick),void this.positionControl(e,s,t.pageX,i))},i.prototype.positionControl=function(t,e,i,s){(this.tools.iClick||this.tools.iClick!==this.dimensions.quantity)&&(this.tools.iClick?this.tools.iClick==this.dimensions.quantity?t<e&&i>=s&&i>this.swipe.divider&&this.moveLeft():t<e&&i>=s&&i>this.swipe.divider?this.moveLeft():this.moveRight():t>=e&&i>s&&i<=this.swipe.divider&&this.moveRight())},i.prototype.recalcPosition=function(t){0===t&&t===this.dimensions.quantity?this.tools.IE?(this.leftNav.className="galleriom-gallery-nav-ie left-nav-ie disabled",this.rightNav.className="galleriom-gallery-nav-ie right-nav-ie disabled"):(this.leftNav.className="galleriom-gallery-nav left-nav disabled",this.rightNav.className="galleriom-gallery-nav right-nav disabled"):0==t?(this.tools.iClick=0,this.tools.IE?this.leftNav.className="galleriom-gallery-nav-ie left-nav-ie disabled":this.leftNav.className="galleriom-gallery-nav left-nav disabled",this.tools.IE?this.rightNav.className="galleriom-gallery-nav-ie right-nav-ie":this.rightNav.className="galleriom-gallery-nav right-nav"):t===this.dimensions.quantity?(this.tools.iClick=this.dimensions.quantity,this.tools.IE?this.rightNav.className="galleriom-gallery-nav-ie right-nav-ie disabled":this.rightNav.className="galleriom-gallery-nav right-nav disabled",this.tools.IE?this.leftNav.className="galleriom-gallery-nav-ie left-nav-ie":this.leftNav.className="galleriom-gallery-nav left-nav"):(this.tools.iClick=t,this.tools.IE?this.leftNav.className="galleriom-gallery-nav-ie left-nav-ie":this.leftNav.className="galleriom-gallery-nav left-nav",this.tools.IE?this.rightNav.className="galleriom-gallery-nav-ie right-nav-ie":this.rightNav.className="galleriom-gallery-nav right-nav"),this.displayImage(t),this.markThumb(t)},i.prototype.displayImage=function(t){this.galleryHolder.style.WebkitTransition="margin-left .4s ease",this.galleryHolder.style.transition="margin-left .4s ease",this.galleryHolder.style.marginLeft=this.dimensions.w*-1*t+"px"},i.prototype.markThumb=function(t){var e,i=document.querySelector(".selected-thumb");e=this.gadget.thumbsView?document.querySelectorAll(".galleriom-thumbs-view img"):document.querySelectorAll(".galleriom-thumbs-dotts"),i&&i.classList.remove("selected-thumb"),e[t]&&e[t].classList.add("selected-thumb")},i.prototype.grabber=function(t){var e;e=t.attributes,e["data-width"]&&(e["data-width"].value.indexOf("%")>=0?t.style.width=e["data-width"].value:t.style.width=parseInt(e["data-width"].value)+"px"),e["data-height"]&&(e["data-height"].value.indexOf("%")>=0?t.style.height=e["data-height"].value:t.style.height=parseInt(e["data-height"].value)+"px"),e["data-thumbs"]&&(this.gadget.thumbsView="true"===e["data-thumbs"].value),e["data-fit"]&&(this.gadget.imageFit=e["data-fit"].value),e["data-caption"]&&(this.gadget.caption="true"===e["data-caption"].value),e["data-preview"]&&(this.gadget.preview="true"===e["data-preview"].value)},i.prototype.elAdjuster=function(t,e){this.setWidth(t,e.w),this.setHeight(t,e.h)},i.prototype.setAttributes=function(t,e){for(var i in e)t.setAttribute(i,e[i])},i.prototype.multipleAppend=function(t,e){for(var i=0,s=e.length;i<s;++i)t.appendChild(e[0])},i.prototype.addListeners=function(t,e,i){e.addEventListener?e.addEventListener(t,i,!1):e.attachEvent&&e.attachEvent("on"+t,i)},i.prototype.detectIEBrowser=function(){var t=document.createElement("div");t.innerHTML="<!--[if lte IE9]> <i></i> <![endif]-->",t.getElementsByTagName("i")[0]&&(this.tools.IE=!0)},i.prototype.detectImages=function(t){if(!t.length)throw new Error("Missing images")},e&&(s=function(t){return new i(t)},t.galleriom=s(e),t.galleriom.startApp(t))}(window,document.getElementById("galleriom-jsgallery-app"));